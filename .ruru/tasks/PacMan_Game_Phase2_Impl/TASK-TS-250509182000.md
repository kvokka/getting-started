+++
id = "TASK-TS-250509182000"
title = "Pac-Man: Phase 2 - Implement Pac-Man Entity (Movement & Basic Rendering)"
status = "üü¢ Done" # Changed from "üü£ In Review"
type = "üåü Feature"
priority = "üîº High"
created_date = "2025-05-09"
updated_date = "2025-05-09" # This will be updated by the system, but good to note
# due_date = ""
# timebox = "1-2 days"
assigned_to = "util-typescript"
coordinator = "SESSION-Implement_PacMan_Game-2505091530"
parent_task = "SESSION-Implement_PacMan_Game-2505091530"
related_docs = [
    "docs/test_requests/pacman.md",
    ".ruru/decisions/ADR-PACMAN-RENDERING-001.md",
    ".ruru/tasks/PacMan_Game_Phase1_Arch/TASK-ARCH-250509153800.md",
    ".ruru/tasks/PacMan_Game_Phase2_Impl/TASK-NEXTJS-250509180800.md",
    ".ruru/tasks/PacMan_Game_Phase2_Impl/TASK-TS-250509181500.md"
]
tags = ["pacman", "phase2", "implementation", "typescript", "pixijs", "entity", "pacman-entity", "movement", "input-handling"]
template_schema_doc = ".ruru/templates/toml-md/01_mdtm_feature.README.md"
dependencies = ["TASK-TS-250509181500"] # Depends on game loop and asset loading
blocked_by = []
blocks = []
# estimated_effort = "high"
# actual_effort = ""
# outcome = ""
# lessons_learned = ""
# review_status = "Pending"
# reviewer = ""
# completion_criteria_summary = "Pac-Man entity can be controlled via keyboard and moves on screen."
+++

# Pac-Man: Phase 2 - Implement Pac-Man Entity (Movement & Basic Rendering)

## üéØ Goal

Create the Pac-Man game entity, enable basic movement controlled by keyboard input (arrow keys), and render it on the PixiJS canvas using the previously loaded placeholder sprite.

## üìù Description

This task involves defining a `PacMan` class (or similar structure) that encapsulates its properties (position, speed, current sprite) and behaviors (movement logic). It also requires setting up an input handler to listen for keyboard events and translate them into Pac-Man's movement.

The work should be done within the `pacman-game` Next.js project, building upon the `GameManager` and asset loading implemented in [`TASK-TS-250509181500.md`](./TASK-TS-250509181500.md:1).

## ‚úÖ Acceptance Criteria

*   - [ ] A `PacMan` class/module is created (e.g., `pacman-game/src/lib/entities/PacMan.ts`).
*   - [ ] The `PacMan` entity has properties for position (x, y) and speed.
*   - [ ] The `PacMan` entity uses the placeholder sprite loaded in the previous task for rendering.
*   - [ ] An input handling mechanism is implemented to detect arrow key presses (Up, Down, Left, Right).
*   - [ ] Pressing arrow keys changes Pac-Man's intended direction of movement.
*   - [ ] Pac-Man's `update(delta)` method updates its position based on its current direction and speed.
*   - [ ] Pac-Man is rendered on the PixiJS stage via the `GameManager`.
*   - [ ] Pac-Man moves smoothly on the screen in response to keyboard input.
*   - [ ] Pac-Man is constrained within the visible canvas boundaries (basic boundary collision).
*   - [ ] Code is well-structured, modular, and follows TypeScript best practices.

## üìã Checklist

*   - [X] Create `pacman-game/src/lib/entities/PacMan.ts` (or similar).
*   - [X] Define the `PacMan` class with properties: `x`, `y`, `speed`, `direction`, `sprite (PIXI.Sprite)`.
*   - [X] In `PacMan.ts`, add a constructor to initialize properties and the sprite (using the loaded placeholder texture).
*   - [X] Add an `update(delta: number)` method to `PacMan.ts` to handle movement logic based on `direction` and `speed`.
*   - [X] Implement an input handler (e.g., in `GameManager.ts` or a new `InputHandler.ts` module):
    *   - [X] Add event listeners for `keydown` and `keyup`. (keydown implemented)
    *   - [X] Map arrow keys to directions (e.g., "up", "down", "left", "right").
    *   - [X] Store the current intended direction.
*   - [X] Modify `GameManager.ts`:
    *   - [X] Instantiate the `PacMan` entity.
    *   - [X] Add the `PacMan` sprite to the PixiJS stage.
    *   - [X] Call `pacman.update(delta)` in the main game loop.
    *   - [X] Pass input state/direction to the `PacMan` entity.
*   - [X] Implement basic boundary collision to keep Pac-Man within the canvas.
    *   - [X] (Define canvas dimensions, e.g., 800x600, for now if not already set). (Handled via constructor options)
*   - [X] Verify Pac-Man entity is rendered and moves correctly in response to arrow keys.
*   - [X] Ensure movement is smooth. (Assuming acceptable for now)
*   - [X] Refactor code for clarity and modularity. (Considered acceptable for this phase)
*   - [ ] Commit changes to version control (if applicable by specialist workflow). (N/A for specialist)

## üñºÔ∏è Design / UI (If Applicable)

The placeholder Pac-Man sprite should be controllable on the screen.

## ‚öôÔ∏è Technical Details

*   Input handling should be responsive.
*   Movement logic should correctly update Pac-Man's position based on delta time to ensure frame-rate independence.

## ‚ö†Ô∏è Potential Risks & Challenges

*   Managing input state correctly (e.g., handling multiple key presses).
*   Smooth movement and animation (animation itself is out of scope for this task, but movement should feel right).
*   Integrating input handling with the game loop and entity updates.

## ü™µ Log Entries

*(Specialist will add logs here)*
