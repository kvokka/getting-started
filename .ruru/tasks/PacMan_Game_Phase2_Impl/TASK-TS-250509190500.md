+++
id = "TASK-TS-250509190500"
title = "Pac-Man: Phase 2 - Implement Maze/Level Manager (Static Maze Rendering)"
status = "üü¢ Done"
type = "üåü Feature"
priority = "üîº High"
created_date = "2025-05-09"
updated_date = "2025-05-09" # Updated by util-typescript
# due_date = ""
# timebox = "1-2 days"
assigned_to = "util-typescript"
coordinator = "SESSION-Implement_PacMan_Game-2505091530"
parent_task = "SESSION-Implement_PacMan_Game-2505091530"
related_docs = [
    "docs/test_requests/pacman.md",
    ".ruru/decisions/ADR-PACMAN-RENDERING-001.md",
    ".ruru/tasks/PacMan_Game_Phase1_Arch/TASK-ARCH-250509153800.md",
    ".ruru/tasks/PacMan_Game_Phase2_Impl/TASK-NEXTJS-250509180800.md",
    ".ruru/tasks/PacMan_Game_Phase2_Impl/TASK-TS-250509181500.md",
    ".ruru/tasks/PacMan_Game_Phase2_Impl/TASK-TS-250509182000.md"
]
tags = ["pacman", "phase2", "implementation", "typescript", "pixijs", "maze", "level-design", "rendering"]
template_schema_doc = ".ruru/templates/toml-md/01_mdtm_feature.README.md"
dependencies = ["TASK-TS-250509182000"] # Depends on Pac-Man entity
blocked_by = []
blocks = []
# estimated_effort = "high"
# actual_effort = ""
# outcome = ""
# lessons_learned = ""
# review_status = "Pending"
# reviewer = ""
# completion_criteria_summary = "A static maze is rendered on the screen, and Pac-Man can collide with its walls."
+++

# Pac-Man: Phase 2 - Implement Maze/Level Manager (Static Maze Rendering & Basic Collision)

## üéØ Goal

Define a simple, static maze structure, implement the logic to render it on the PixiJS canvas, and enable basic collision detection between the Pac-Man entity and the maze walls.

## üìù Description

This task involves creating a `MazeManager` (or similar) module responsible for defining the maze layout (e.g., using a 2D array representing tiles like walls and empty paths). It will then render this maze using PixiJS graphics primitives. Basic AABB (Axis-Aligned Bounding Box) collision detection will be implemented to prevent Pac-Man from moving through walls.

The work should be done within the `pacman-game` Next.js project, building upon the `GameManager` and `PacMan` entity implemented in previous tasks.

## ‚úÖ Acceptance Criteria

*   - [‚úÖ] A `MazeManager` class/module is created (e.g., `pacman-game/src/lib/maze/MazeManager.ts`).
*   - [‚úÖ] A simple, static maze layout is defined (e.g., as a 2D array or configuration object).
    *   Example tile types: `0` for empty path, `1` for wall.
*   - [‚úÖ] The `MazeManager` can render the maze onto the PixiJS stage (e.g., drawing rectangles for walls).
*   - [‚úÖ] The `GameManager` integrates the `MazeManager` to display the maze.
*   - [‚úÖ] Basic collision detection logic (e.g., AABB) is implemented between Pac-Man and maze walls.
*   - [‚úÖ] Pac-Man is prevented from moving into wall tiles.
*   - [‚úÖ] The visual representation of the maze is clear.
*   - [‚úÖ] Code is well-structured, modular, and follows TypeScript best practices.

## üìã Checklist

*   - [‚úÖ] Create `pacman-game/src/lib/maze/MazeManager.ts` (or similar).
*   - [‚úÖ] Define a simple static maze layout within `MazeManager.ts` or a separate config file (e.g., `mazeLayout.ts`).
    *   Specify tile size (e.g., `tileSize = 20` pixels).
*   - [‚úÖ] Implement a `renderMaze(stage: PIXI.Container)` method in `MazeManager.ts` to draw the maze using `PIXI.Graphics` for walls.
*   - [‚úÖ] Modify `GameManager.ts`:
    *   - [‚úÖ] Instantiate the `MazeManager`.
    *   - [‚úÖ] Call `mazeManager.renderMaze()` to add the maze to the stage.
*   - [‚úÖ] Implement collision detection logic:
    *   - [‚úÖ] Add a method in `MazeManager.ts` like `isWall(x: number, y: number): boolean` that checks if a given grid coordinate is a wall.
    *   - [‚úÖ] Modify `PacMan.update()` or `GameManager.update()` to check for potential collisions *before* moving Pac-Man.
    *   - [‚úÖ] If a move would result in a collision, prevent the move in that direction.
*   - [‚úÖ] Verify the maze is rendered correctly.
*   - [‚úÖ] Verify Pac-Man collides with walls and cannot pass through them.
*   - [‚úÖ] Refactor code for clarity and modularity.
*   - [ ] Commit changes to version control (if applicable by specialist workflow).

## üñºÔ∏è Design / UI (If Applicable)

A visible maze structure on the canvas, with Pac-Man interacting with its boundaries.

## ‚öôÔ∏è Technical Details

*   Collision detection can start with simple tile-based checks.
*   The maze layout should be easily modifiable for future levels.

## ‚ö†Ô∏è Potential Risks & Challenges

*   Accurate collision detection logic, especially at tile edges.
*   Ensuring Pac-Man's movement feels natural when colliding (e.g., sliding along walls vs. stopping abruptly). This task focuses on stopping.
*   Performance implications if the maze is very large or rendering is inefficient (less of a concern for a simple static maze).

## ü™µ Log Entries

- 2025-05-09 19:05: util-typescript: Started processing task.
- 2025-05-09 19:05: util-typescript: Created `pacman-game/src/lib/maze/MazeManager.ts` with maze layout and rendering logic.
- 2025-05-09 19:05: util-typescript: Modified `pacman-game/src/lib/GameManager.ts` to instantiate MazeManager, render maze, and implement basic Pac-Man/wall collision detection.
- 2025-05-09 19:05: util-typescript: Modified `pacman-game/src/lib/entities/PacMan.ts` to include `currentDirection` property and updated `setDirection` method.
- 2025-05-09 19:05: util-typescript: Corrected `GameManager.ts` to properly use `PacMan.setDirection()` and `PacMan.currentDirection`.
- 2025-05-09 19:05: util-typescript: All checklist items completed. Task status set to Done.
